!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t){var i,n;i=jQuery,n={editorType:"",canRefresh:!1,Refreshing:!1,Throttling:!1,PrivateContent:!1,refreshDelay:500,refreshDelayTrottle:2400,init:function(){if(this.$metabox=i("#seokey-metabox .inside #tab-seokey-audit"),!(this.$metabox.length<1))if(this.$optimisations=i("#seokey-audit-content-optimisations"),this.setEditorType(),this.initActions(),!0!==i('input[name="content_visibility"]').prop("checked"))this.refresh();else{var e=wp.i18n.__;this.$optimisations.html(e("This is a private content: we do not audit them.","seo-key"))}},setEditorType:function(){!0===document.body.classList.contains("block-editor-page")?(this.editorType="gutenberg",this.editor=wp.data.select("core/editor")):(this.editorType="mce",this.editor=tinyMCE.activeEditor)},getContent:function(){this.content={};var e=i('input[name="seokey_audit_content_main_keyword"]').val();switch(console.log(this.editorType),this.editorType){case"gutenberg":var t=i('input[name="metatitle"]').val();t||(t=this.editor.getEditedPostAttribute("title"));var n=i('textarea[name="metadesc"]').val();n||(n=this.editor.getEditedPostAttribute("excerpt"));var o=this.editor.getEditedPostContent(),r=document.createElement("div");r.innerHTML=o;for(var s=r.getElementsByTagName("iframe");s[0];)s[0].parentNode.removeChild(s[0]);o=r.innerHTML,(a=i("#seokey-googlepreview-desc").text()).length<1&&(a=""),this.content={title:t,excerpt:n,metadesc:a,id:wp.data.select("core/editor").getCurrentPostId(),date:wp.data.select("core/editor").getEditedPostAttribute("date"),author:wp.data.select("core/editor").getEditedPostAttribute("author"),content:o,permalink:this.editor.getPermalink(),keyword:e,editortype:"gutenberg"};break;case"mce":default:var a,c=i("#excerpt").text();c.length<1&&(c=""),(a=i("#seokey-googlepreview-desc").text()).length<1&&(a=""),this.content={title:i("#seokey-googlepreview-title").text(),excerpt:c,metadesc:a,id:i("#post_ID").val(),author:i("#post_author_override").find(":selected").val(),content:tinymce.get("content").getContent(),permalink:i("#sample-permalink a").text(),keyword:e,editortype:"classic"}}},initActions:function(){var e=this;!0===i('input[name="content_visibility"]').checked?e.PrivateContent=!0:e.PrivateContent=!1;var t=function(t,i){if(!n&&!0!==e.Throttling)var n=setTimeout((function(){t(),n=void 0}),i)};function n(){switch(e.editorType){case"gutenberg":!0!==wp.data.select("core/block-editor").isTyping()&&e.refresh();break;case"mce":e.refresh()}e.Throttling=!1}function o(){if(!0===i('input[name="content_visibility"]').prop("checked")){e.PrivateContent=!0,e.$optimisations.empty();var o=wp.i18n.__;e.$optimisations.html(o("This is a private content: we do not audit them.","seo-key"))}else!1===e.Throttling&&!1===e.Refreshing&&(t(n,e.refreshDelayTrottle),e.Throttling=!0),e.PrivateContent=!1}switch(i("#content_main_keyword_submit").on("click",(function(){o()})),i('input[name="content_visibility"]').on("click",(function(){o()})),this.editorType){case"gutenberg":wp.data.subscribe((function(){var i=wp.data.select("core/editor").isSavingPost(),o=wp.data.select("core/editor").isAutosavingPost();if(i&&!o&&(e.canRefresh=!0,e.refresh()),!o){var r=wp.data.select("core/editor").getCurrentPost(),s=Object.keys(r);s&&s.forEach((function(i){wp.data.select("core/editor").getEditedPostAttribute(i)===r[i]||e.Throttling||"guid"!==i&&(t(n,e.refreshDelayTrottle),e.Throttling=!0)}))}}));break;case"mce":this.editor.on("keyup",(function(){e.refresh()})),this.editor.on("Change",(function(){e.refresh()}))}},refresh:function(){var e=this;if(!1===e.PrivateContent)e.canRefresh=!1,clearInterval(this.timer),this.timer=setTimeout((function(){e.canRefresh=!0,e.request()}),this.refreshDelay);else{e.$optimisations.empty();var t=wp.i18n.__;e.$optimisations.html(t("This is a private content: we do not audit them.","seo-key"))}},request:function(){if(!0===this.canRefresh&&!1===this.Refreshing){var e=this;this.canRefresh=!1,this.Refreshing=!0,this.getContent(),e.$optimisations.empty(),i("#audit-content-loader").show(),i.ajax({url:seokey_audit_content.ajaxUrl,method:"POST",data:{action:"seokey_audit_content_check",security:seokey_audit_content.security,datas:e.content},success:function(t){!0===t.success?setTimeout((function(){e.$optimisations.empty(),e.$optimisations.html("<ul>"+t.data+"</ul>"),e.Refreshing=!1,i("#audit-content-loader").hide(),"function"==typeof seokey_issues_handler&&seokey_issues_handler()}),2e3):(e.Refreshing=!1,i("#audit-content-loader").hide())},error:function(t){e.Refreshing=!1,i("#audit-content-loader").hide()}})}}},i(window).on("load",(function(){setTimeout((function(){n.init()}),3e3)}))}]);