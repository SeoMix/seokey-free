!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e){var i,n;i=jQuery,n={editorType:"",canRefresh:!1,Refreshing:!1,Throttling:!1,PrivateContent:!1,refreshDelay:500,refreshDelayTrottle:2400,init:function(){this.$metabox=i("#seokey-metabox .inside #tab-seokey-audit"),this.$metabox.length<1||(this.$optimisations=i("#seokey-audit-content-optimisations"),this.setEditorType(),this.initActions(),!0!==i('input[name="content_visibility"]').prop("checked")?this.refresh():this.$optimisations.html("This is a private content : we do not audit them"))},setEditorType:function(){!0===document.body.classList.contains("block-editor-page")?(this.editorType="gutenberg",this.editor=wp.data.select("core/editor")):(this.editorType="mce",this.editor=tinyMCE.activeEditor)},getContent:function(){this.content={};var t=i('input[name="seokey_audit_content_main_keyword"]').val();switch(console.log(this.editorType),this.editorType){case"gutenberg":var e=i('input[name="metatitle"]').val();e||(e=this.editor.getEditedPostAttribute("title"));var n=i('textarea[name="metadesc"]').val();n||(n=this.editor.getEditedPostAttribute("excerpt"));var o=this.editor.getEditedPostContent(),r=document.createElement("div");r.innerHTML=o;for(var s=r.getElementsByTagName("iframe");s[0];)s[0].parentNode.removeChild(s[0]);o=r.innerHTML,(a=i("#seokey-googlepreview-desc").text()).length<1&&(a=""),this.content={title:e,excerpt:n,metadesc:a,id:wp.data.select("core/editor").getCurrentPostId(),date:wp.data.select("core/editor").getEditedPostAttribute("date"),author:wp.data.select("core/editor").getEditedPostAttribute("author"),content:o,permalink:this.editor.getPermalink(),keyword:t,editortype:"gutenberg"};break;case"mce":default:var a,c=i("#excerpt").text();c.length<1&&(c=""),(a=i("#seokey-googlepreview-desc").text()).length<1&&(a=""),this.content={title:i("#seokey-googlepreview-title").text(),excerpt:c,metadesc:a,id:i("#post_ID").val(),author:i("#post_author_override").find(":selected").val(),content:tinymce.get("content").getContent(),permalink:i("#sample-permalink a").text(),keyword:t,editortype:"classic"}}},initActions:function(){var t=this;!0===i('input[name="content_visibility"]').checked?t.PrivateContent=!0:t.PrivateContent=!1;var e=function(e,i){if(!n&&!0!==t.Throttling)var n=setTimeout((function(){e(),n=void 0}),i)};function n(){switch(t.editorType){case"gutenberg":!0!==wp.data.select("core/block-editor").isTyping()&&t.refresh();break;case"mce":t.refresh()}t.Throttling=!1}function o(){!0===i('input[name="content_visibility"]').prop("checked")?(t.PrivateContent=!0,t.$optimisations.empty(),t.$optimisations.html("This is a private content : we do not audit them")):(!1===t.Throttling&&!1===t.Refreshing&&(e(n,t.refreshDelayTrottle),t.Throttling=!0),t.PrivateContent=!1)}switch(i("#content_main_keyword_submit").on("click",(function(){o()})),i('input[name="content_visibility"]').on("click",(function(){o()})),this.editorType){case"gutenberg":wp.data.subscribe((function(){var i=wp.data.select("core/editor").isSavingPost(),o=wp.data.select("core/editor").isAutosavingPost();if(i&&!o&&(t.canRefresh=!0,t.refresh()),!o){var r=wp.data.select("core/editor").getCurrentPost(),s=Object.keys(r);s&&s.forEach((function(i){wp.data.select("core/editor").getEditedPostAttribute(i)===r[i]||t.Throttling||"guid"!==i&&(e(n,t.refreshDelayTrottle),t.Throttling=!0)}))}}));break;case"mce":this.editor.on("keyup",(function(){t.refresh()})),this.editor.on("Change",(function(){t.refresh()}))}},refresh:function(){var t=this;!1===t.PrivateContent?(t.canRefresh=!1,clearInterval(this.timer),this.timer=setTimeout((function(){t.canRefresh=!0,t.request()}),this.refreshDelay)):(t.$optimisations.empty(),t.$optimisations.html("This is a private content : we do not audit them"))},request:function(){if(!0===this.canRefresh&&!1===this.Refreshing){var t=this;this.canRefresh=!1,this.Refreshing=!0,this.getContent(),t.$optimisations.empty(),i("#audit-content-loader").show(),i.ajax({url:seokey_audit_content.ajaxUrl,method:"POST",data:{action:"seokey_audit_content_check",security:seokey_audit_content.security,datas:t.content},success:function(e){!0===e.success?setTimeout((function(){t.$optimisations.empty(),t.$optimisations.html("<ul>"+e.data+"</ul>"),t.Refreshing=!1,i("#audit-content-loader").hide(),seokey_issues_handler()}),2e3):(t.Refreshing=!1,i("#audit-content-loader").hide())},error:function(e){t.Refreshing=!1,i("#audit-content-loader").hide()}})}}},i(window).on("load",(function(){setTimeout((function(){n.init()}),3e3)}))}]);