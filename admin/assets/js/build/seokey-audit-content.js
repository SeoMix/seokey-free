!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e){var i,n;i=jQuery,n={editorType:"",canRefresh:!1,Refreshing:!1,Throttling:!1,PrivateContent:!1,refreshDelay:500,refreshDelayTrottle:2400,init:function(){if(this.$metabox=i("#seokey-metabox .inside #tab-seokey-audit"),!(this.$metabox.length<1))if(this.$optimisations=i("#seokey-audit-content-optimisations"),this.setEditorType(),this.initActions(),!0!==i('input[name="content_visibility"]').prop("checked"))this.refresh();else{var t=wp.i18n.__;this.$optimisations.html(t("This is a private content: we do not audit them.","seo-key"))}},setEditorType:function(){!0===document.body.classList.contains("block-editor-page")?(this.editorType="gutenberg",this.editor=wp.data.select("core/editor")):(this.editorType="mce",this.editor=tinyMCE.activeEditor)},getContent:function(){this.content={};var t=i('input[name="seokey_audit_content_main_keyword"]').val();switch(this.editorType){case"gutenberg":(r=i('input[name="metatitle"]').val())||(r=this.editor.getEditedPostAttribute("title")),(s=i("#metatitle").val()).length<1&&(s="");var e=i('textarea[name="metadesc"]').val();e||(e=this.editor.getEditedPostAttribute("excerpt"));var n=this.editor.getEditedPostContent(),o=document.createElement("div");o.innerHTML=n;for(var a=o.getElementsByTagName("iframe");a[0];)a[0].parentNode.removeChild(a[0]);n=o.innerHTML,(c=i("#seokey-googlepreview-desc").text()).length<1&&(c=""),(d=i("#meta-tags-inputs-textarea").val()).length<1&&(d=""),u=(u=document.querySelectorAll("button.editor-post-featured-image__preview")).length>0?1:-1,this.content={title:r,title_manual:s,excerpt:e,metadesc:c,metadesc_manual:d,id:wp.data.select("core/editor").getCurrentPostId(),image:u,date:wp.data.select("core/editor").getEditedPostAttribute("date"),author:wp.data.select("core/editor").getEditedPostAttribute("author"),content:n,permalink:this.editor.getPermalink(),keyword:t,editortype:"gutenberg"};break;case"mce":default:var r,s,c,d,l=i("#excerpt").text();l.length<1&&(l=""),(r=i("#seokey-googlepreview-title").text()).length<1&&(r=""),(s=i("#seokey-metabox #metatitle").val()).length<1&&(s=""),(c=i("#seokey-googlepreview-desc").text()).length<1&&(c=""),(d=i("#meta-tags-inputs-textarea").val()).length<1&&(d="");var u,h=tinymce.get("content").getContent(),f=i("#post_type").val();f.length>=1&&(f=tinymce.get("excerpt"))&&f.getContent()&&(h=h+" "+f.getContent()),u=(u=document.getElementById("_thumbnail_id")).value,this.content={title:r,title_manual:s,excerpt:l,metadesc:c,metadesc_manual:d,id:i("#post_ID").val(),image:u,author:i("#post_author_override").find(":selected").val(),content:h,permalink:i("#sample-permalink a").text(),keyword:t,editortype:"classic"}}if(i(".seokey-is-auditable").length){var m="";i(".seokey-is-auditable").each((function(){switch(i(this).attr("data-type")){case"url":""!==i(this).find("input").val()&&(m+=' <a href="'+i(this).find("input").val()+'">ACF-link-added-with-SeoKey</a>');break;case"image":""!==i(this).find("img").attr("src")&&(m+=' <img src="'+i(this).find("img").attr("src")+'" alt="'+i(this).find("img").attr("alt")+'">');break;case"gallery":i(this).find(".acf-gallery-attachments .acf-gallery-attachment").each((function(){""!==i(this).find("img").attr("src")&&(m+=' <img src="'+i(this).find("img").attr("src")+'" alt="'+i(this).find("img").attr("alt")+'">')}));break;case"email":case"text":""!==i(this).find("input").val()&&(m+=" "+i(this).find("input").val());break;case"textarea":case"wysiwyg":""!==i(this).find("textarea").val()&&(m+=" "+i(this).find("textarea").val())}})),this.content.content+=m}},initActions:function(){var t=this;!0===i('input[name="content_visibility"]').checked?t.PrivateContent=!0:t.PrivateContent=!1;var e=function(e,i){if(!n&&!0!==t.Throttling)var n=setTimeout((function(){e(),n=void 0}),i)};function n(){switch(t.editorType){case"gutenberg":!0!==wp.data.select("core/block-editor").isTyping()&&t.refresh();break;case"mce":t.refresh()}t.Throttling=!1}function o(){if(!0===i('input[name="content_visibility"]').prop("checked")){t.PrivateContent=!0,t.$optimisations.empty();var o=wp.i18n.__;t.$optimisations.html(o("This is a private content: we do not audit them.","seo-key"))}else!1===t.Throttling&&!1===t.Refreshing&&(e(n,t.refreshDelayTrottle),t.Throttling=!0),t.PrivateContent=!1}switch(i("#content_main_keyword_submit").on("click",(function(){o()})),i('input[name="content_visibility"]').on("click",(function(){o()})),i(".seokey-is-auditable input, .seokey-is-auditable textarea").on("change",(function(){o()})),this.editorType){case"gutenberg":wp.data.subscribe((function(){var i=wp.data.select("core/editor").isSavingPost(),o=wp.data.select("core/editor").isAutosavingPost();if(i&&!o&&(t.canRefresh=!0,t.refresh()),!o){var a=wp.data.select("core/editor").getCurrentPost(),r=Object.keys(a);r&&r.forEach((function(i){wp.data.select("core/editor").getEditedPostAttribute(i)===a[i]||t.Throttling||"guid"!==i&&(e(n,t.refreshDelayTrottle),t.Throttling=!0)}))}}));break;case"mce":this.editor.on("keyup",(function(){t.refresh()})),this.editor.on("Change",(function(){t.refresh()}))}},refresh:function(){var t=this;if(!1===t.PrivateContent)t.canRefresh=!1,clearInterval(this.timer),this.timer=setTimeout((function(){t.canRefresh=!0,t.request()}),this.refreshDelay);else{t.$optimisations.empty();var e=wp.i18n.__;t.$optimisations.html(e("This is a private content: we do not audit them.","seo-key"))}},request:function(){if(!0===this.canRefresh&&!1===this.Refreshing){var t=this;this.canRefresh=!1,this.Refreshing=!0,this.getContent(),t.$optimisations.empty(),i("#audit-content-loader").show(),i.ajax({url:seokey_audit_content.ajaxUrl,method:"POST",data:{action:"seokey_audit_content_check",security:seokey_audit_content.security,datas:t.content,et_load_builder_modules:1},success:function(e){!0===e.success?setTimeout((function(){t.$optimisations.empty(),t.$optimisations.html("<ul>"+e.data+"</ul>"),t.Refreshing=!1,i("#audit-content-loader").hide(),"function"==typeof seokey_issues_handler&&seokey_issues_handler(),i("body").reloadTooltip()}),2e3):(t.Refreshing=!1,i("#audit-content-loader").hide(),i("body").reloadTooltip())},error:function(e){t.Refreshing=!1,i("#audit-content-loader").hide()}})}}},i(window).on("load",(function(){setTimeout((function(){n.init(),i("body").reloadTooltip()}),3e3)}))}]);